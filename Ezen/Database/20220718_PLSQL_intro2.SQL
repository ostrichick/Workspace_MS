-- 반복문
-- 예제4 WHILE을 이용해 1부터 100까지 합

DECLARE
	TOTALSUM NUMBER;
	I NUMBER;
BEGIN
	I:=0;
	TOTALSUM:=0;
	WHILE(I<=100)
	LOOP
		TOTALSUM := TOTALSUM + I;
		I := I+1;
	END LOOP;
	DBMS_OUTPUT.PUT_LINE(TOTALSUM);
END;

-- FOR 사용
DECLARE
	TOTALSUM NUMBER;
	I NUMBER;
BEGIN
	TOTALSUM:=0;
	FOR I IN 1 .. 100
	LOOP
	 TOTALSUM := TOTALSUM+I;
	END LOOP;
	DBMS_OUTPUT.PUT_LINE(TOTALSUM);
END;

-- 보조 제어문 CONTINUE, EXIT, (자바 CONTINUE,BREAK)
-- 예제5 CONTINUE와 EXIT추가 1부터 100까지 합, 7의 배수 제외, 합 1000초과시 출력

DECLARE
	TOTALSUM NUMBER;
	I NUMBER;
	J NUMBER;
BEGIN
	TOTALSUM:=0;
	FOR I IN 1 .. 100
	LOOP

	 IF MOD(I,7)=0 THEN CONTINUE;
	 END IF;
	 IF TOTALSUM > 1000 THEN EXIT;
	 END IF;
	 TOTALSUM := TOTALSUM+I;
	 J:=I;
	END LOOP;
	DBMS_OUTPUT.PUT_LINE('숫자 '||J||', 합계 '||TOTALSUM);
END;

-- 예외처리
-- EMPLOYEES 테이블에서 GILDONG이라는 이름을조회할 때 이름이 없으면 예외처리하여 해당직원 없음 출력
DECLARE
	USER_NAME EMPLOYEES.FIRST_NAME%TYPE;
BEGIN
	--USER_NAME := 'GILDONG';
	SELECT FIRST_NAME INTO USER_NAME FROM EMPLOYEES
		WHERE FIRST_NAME = 'Neena';
			DBMS_OUTPUT.PUT_LINE(USER_NAME||' 직원임 O');

		EXCEPTION
			WHEN NO_DATA_FOUND THEN
				DBMS_OUTPUT.PUT_LINE(USER_NAME||' 직원 아님 X');
END;

-- 예제7 SQL문 실행시키는 EXECUTE IMMEDIATE 활용

EXEC INSERT_FRUIT('MANGO', 5000);

CREATE TABLE FRUIT_TBL(
	FRUIT_NAME VARCHAR2(50) NOT NULL,
	PRICE NUMBER DEFAULT 0
);

CREATE OR REPLACE PROCEDURE INSERT_FRUIT(
	FRUIT IN FRUIT_TBL.FRUIT_NAME%TYPE,
	PRICE IN NUMBER
) AS
	V_SQL VARCHAR2(200);

BEGIN
	V_SQL := 'INSERT INTO FRUIT_TBL VALUES('''||FRUIT||''','''||PRICE||''')';
	EXECUTE IMMEDIATE V_SQL;
	DBMS_OUTPUT.PUT_LINE(V_SQL);
END;

